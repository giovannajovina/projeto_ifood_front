<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clone iFood</title>
    <link rel="stylesheet" href="../pagina_inicial/style.css">
    <script src="../config.js"></script>
    <script src="../pagina_inicial/index.js"></script>
    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBkykjH21ut-e8c_F90tJmgO6IX2KvALZ4&libraries=places&callback=initAutocomplete"
        async defer></script>

</head>

<body>
    <header>
        <div class="logo">iFood Clone</div>

        <div class="navbar">

            <div class="search-bar">
                <input type="text" placeholder="Busque por item ou loja">
            </div>
            <div class="icons">
                <button id="openModalBtn">Escolher Endere√ßo</button>
                <span class="location-icon" onclick="toggleModal()"><img src="../pagina_inicial/imagens/do-utilizador.png" alt=""></span>
                <span>üõí</span>
            </div>
            <div class="menu-toggle" onclick="toggleMenu()">‚ò∞</div>
        </div>
        <div class="mobile-nav" id="mobileNav">
            <ul>
                <li><a href="#">In√≠cio</a></li>
                <li><a href="#">Restaurantes</a></li>
                <button id="openModalBtn-mobile">Escolher Endere√ßo</button>
            </ul>
        </div>
    </header>
    <div id="addressModal" class="modal_loc">
        <div class="modal_loc-content">
            <span class="close_loc">&times;</span>

            <!-- Imagem no topo -->
            <div class="modal-image">
                <img src="../pagina_inicial/imagens/logo.png" alt="Localiza√ß√£o" />
            </div>

            <h2>Onde voc√™ quer receber seu pedido?</h2>

            <div class="search-container">
                <input type="text" id="addressSearch" placeholder="Buscar endere√ßo e n√∫mero">
            </div>

            <ul id="suggestions"></ul>
            <h3>Endere√ßos Salvos</h3>
            <ul id="savedAddresses"></ul>

            <div class="use-location-btn">
                <button id="useMyLocation">Usar minha localiza√ß√£o</button>
            </div>

            <p class="login-text">
                J√° tem um endere√ßo salvo? <a href="../entrar/index.html" class="login-link">Entrar ou cadastrar</a>
            </p>
        </div>
    </div>
    <div id="addressDetailsModal" class="modal_loc">
        <div class="modal_loc-content">
            <span class="close_loc" id="closeAddressDetails">&times;</span>
            <div class="modal-image">
                <img src="../pagina_inicial/imagens/logo.png" alt="Localiza√ß√£o" />
            </div>
            <h2>Confirme os detalhes do endere√ßo</h2>
            <div class="search-container">
                <p id="selectedAddress"></p>
            </div>
            <div class="divisao">
                <div class="search-container">
                    <input type="text" id="numero" placeholder="N√∫mero">
                </div>
                <div class="search-container">
                    <input type="text" id="complemento" placeholder="Complemento">
                </div>
            </div>
            <div class="buttons-address">
                <button id="saveAddress">Salvar</button>
                <button id="saveAddress">Voltar</button>
            </div>
        </div>
    </div>
    <!-- Fundo escurecido -->
    <div id="editOverlay" class="modal-overlay"></div>

    <!-- Modal de edi√ß√£o -->
    <div id="editAddressModal" class="modal">
        <span class="close" onclick="closeEditModal()">&times;</span>
        <h2>Editar Endere√ßo</h2>
        <p id="editLogradouro"></p>
        <label>N√∫mero:</label>
        <input type="text" id="editNumero" placeholder="Digite o n√∫mero">
        <label>Complemento:</label>
        <input type="text" id="editComplemento" placeholder="Digite o complemento">
        <button id="saveEditBtn">Salvar Altera√ß√µes</button>
    </div>
    <div id="sideModal" class="modal">
        <span class="close-btn" onclick="toggleModal()">&times;</span>
        <div class="nome">
            <h2> Ol√°, </h2>
            <h2 id="nome"> </h2>
        </div>
        <ul class="menu-list">
            <li><img src="../pagina_inicial/imagens/pedidos.png" alt="Pedidos">Pedidos</li>
            <li><img src="../pagina_inicial/imagens/dinheiro.png" alt="Pagamento">Pagamento</li>
            <li><img src="../pagina_inicial/imagens/conf.png" alt="Meus Dados"> <a href="../meus dados/index.html">Meus dados</a></li>
            <li><img src="../pagina_inicial/imagens/endereco.png" alt="Meus Dados">Meu endere√ßo</li>
        </ul>
    </div>

    <script>
        function toggleMenu() {
            document.getElementById("mobileNav").classList.toggle("active");
        }
        function toggleModal() {
            document.getElementById('sideModal').classList.toggle('active');
        }
    </script>
 <div class="form-wrapper-pessoal">
    <div class="form-container-pessoal">
      <h2>Editar informa√ß√µes pessoais</h2>
      <form>
        <label for="perfil_nome">Nome completo</label>
        <input type="text" id="perfil_nome" name="nome" placeholder="Giovanna Santos">

        <label for="perfil_cpf">CPF</label>
        <input type="text" id="perfil_cpf" name="cpf" placeholder="452.776.508-65" disabled>

        <label for="perfil_email">E-mail</label>
        <input type="email" id="perfil_email" name="email" placeholder="giovanna@email.com">

        <label for="perfil_telefone">Telefone de contato</label>
        <input type="tel" id="perfil_telefone" name="telefone" placeholder="(11) 91234-5678">

        <div class="form-buttons-pessoal">
          <button type="button" class="btn-pessoal btn-voltar-pessoal">Voltar</button>
          <button type="submit" class="btn-pessoal btn-salvar-pessoal">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(async function () {
      const userJson = localStorage.getItem('user');
        console.log(userJson)
      if (!userJson) {
        console.warn('Usu√°rio n√£o encontrado no localStorage.');
        return;
      }

      const user = JSON.parse(userJson);
      const userId = user.id;
      console.log(userId);

      try {
        const response = await fetch(`https://clickfood.shop/api/usuario/list/${userId}`); 
        console.log(response)
        if (!response.ok) throw new Error('Erro ao buscar dados do usu√°rio');

        const dados = await response.json();
        console.log(dados)

        $('#perfil_nome').val(dados[0].nome || '');
        $('#perfil_cpf').val(dados[0].cpf || '');
        $('#perfil_email').val(dados[0].email || '');
        $('#perfil_telefone').val(dados[0].telefone || '');
      } catch (error) {
        console.error('Erro ao carregar dados:', error);
        alert('N√£o foi poss√≠vel carregar os dados do usu√°rio.');
      }
    });
  </script>
  </body>
  </html>